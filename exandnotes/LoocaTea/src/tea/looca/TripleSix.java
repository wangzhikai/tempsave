package tea.looca;
import java.util.ArrayList;
import java.util.List;
import java.util.regex.Matcher;
import java.util.regex.Pattern;


public class TripleSix {
	public static int computer (String str) {
		int result = -1;

		
		// Concatenate all
		//str = str.replaceAll("c", "");
		System.out.println(str);
		// Replace all op1*op2
		//str = str.replaceAll("c", "");
		Pattern p = Pattern.compile("[0-9]+[*][0-9]+");
		Matcher m = p.matcher(str);
		while (m.find()) {
			String tmp = str.substring(m.start(),m.end());
			String [] tmparr = tmp.split("[*]");
			CharSequence s1 = tmp;

			//str = str.replaceAll(tmp, ""+(Integer.parseInt(tmparr[0]) * Integer.parseInt(tmparr[1])));
			str = str.replace(s1, ""+(Integer.parseInt(tmparr[0]) * Integer.parseInt(tmparr[1])));
			p = Pattern.compile("[0-9]+[*][0-9]+");
			m = p.matcher(str);
		}
		System.out.println(str);
		
		p = Pattern.compile("[0-9]+[+][0-9]+");
		m = p.matcher(str);
		while (m.find()) {
			String tmp = str.substring(m.start(),m.end());
			String [] tmparr = tmp.split("[+]");
			CharSequence s1 = tmp;

			//str = str.replaceAll(tmp, ""+(Integer.parseInt(tmparr[0]) * Integer.parseInt(tmparr[1])));
			str = str.replace(s1, ""+(Integer.parseInt(tmparr[0])+ Integer.parseInt(tmparr[1])));
			p = Pattern.compile("[0-9]+[+][0-9]+");
			m = p.matcher(str);
		}
		System.out.println(str);
		str = str.replaceAll("c", "");
		System.out.println(str);

		return result=Integer.parseInt(str);
	}	
	
	public static int computerbk (String str) {
		int result = -1;

		
		// Concatenate all
		str = str.replaceAll("c", "");
		System.out.println(str);
		// Replace all op1*op2
		//str = str.replaceAll("c", "");
		Pattern p = Pattern.compile("[0-9]+[*][0-9]+");
		Matcher m = p.matcher(str);
		while (m.find()) {
			String tmp = str.substring(m.start(),m.end());
			String [] tmparr = tmp.split("[*]");
			CharSequence s1 = tmp;

			//str = str.replaceAll(tmp, ""+(Integer.parseInt(tmparr[0]) * Integer.parseInt(tmparr[1])));
			str = str.replace(s1, ""+(Integer.parseInt(tmparr[0]) * Integer.parseInt(tmparr[1])));
			p = Pattern.compile("[0-9]+[*][0-9]+");
			m = p.matcher(str);
		}
		
		
		
		
		// grep the first number
		p = Pattern.compile("[0-9]+");
		m = p.matcher(str);

		if (m.find()) {
			String tmp = str.substring(m.start(),m.end());
			result = Integer.parseInt(tmp);
			System.out.print(result );
		} // else  not need to handle exception

		str = str.substring(m.end());
		//while (not end of str) {
		while ( str.length() > 0 ) {
			// grep an op
			 p = Pattern.compile("[+|*]");
			 m = p.matcher(str);
			 String operator = ""; 
					 
				if (m.find()) {
					String tmp = str.substring(m.start(),m.end());
					System.out.print(" "+tmp );
					operator = tmp;
				} // else  not need to handle exception
				str = str.substring(m.end());

			// grep an optor2
				p = Pattern.compile("[0-9]+");
				m = p.matcher(str);

				int opt2 = -1;
				if (m.find()) {
					String tmp = str.substring(m.start(),m.end());
					opt2 = Integer.parseInt(tmp);
					System.out.print(" "+ opt2 );
				} // else  not need to handle exception
				str = str.substring(m.end());
			
			// operate
			if (operator.equals("+")) {
				result = result + opt2;
			} else {
				result = result * opt2;
			}
			
		}
		System.out.println(" ="+ result);
		return result;
	}
	static int [] arr = new int [] {1,2,3,5,2,4};
	static char [] ops = new char [] {'c','+','*'};
	static int count = 0;
	static int goal = 666;
	static List<String> answers = new ArrayList<String>();
	
	public static void bruteFormulae (int elementIndex,  String formula) {
		if (elementIndex >= arr.length) {
			//System.out.println(formula);
			if (goal == computer(formula) )
				//System.out.println("Anser ======= "+formula);
				answers.add(formula);
		} else {
			String newFormula = "";
			for ( char op : ops) {
				if (elementIndex == 1) {
					newFormula =""+arr[elementIndex-1]+op + arr[elementIndex];
				} else {
					newFormula = formula +"" + op + arr[elementIndex];
				}
				bruteFormulae (elementIndex+1,  newFormula);
			}
		}
	}

	public static void main(String[] args) {
		bruteFormulae(1,"");
		System.out.println("========");
		for (String str: answers) {
			System.out.println(str);
		}
	}

}
/* OUTPUT
123524
123524 =123524
12352+4
12352 + 4 =12356
12352*4
49408 =49408
1235+24
1235 + 24 =1259
1235+2+4
1235 + 2 + 4 =1241
1235+2*4
1235 + 8 =1243
1235*24
29640 =29640
1235*2+4
2470 + 4 =2474
1235*2*4
9880 =9880
123+524
123 + 524 =647
123+52+4
123 + 52 + 4 =179
123+52*4
123 + 208 =331
123+5+24
123 + 5 + 24 =152
123+5+2+4
123 + 5 + 2 + 4 =134
123+5+2*4
123 + 5 + 8 =136
123+5*24
123 + 120 =243
123+5*2+4
123 + 10 + 4 =137
123+5*2*4
123 + 40 =163
123*524
64452 =64452
123*52+4
6396 + 4 =6400
123*52*4
25584 =25584
123*5+24
615 + 24 =639
123*5+2+4
615 + 2 + 4 =621
123*5+2*4
615 + 8 =623
123*5*24
14760 =14760
123*5*2+4
1230 + 4 =1234
123*5*2*4
4920 =4920
12+3524
12 + 3524 =3536
12+352+4
12 + 352 + 4 =368
12+352*4
12 + 1408 =1420
12+35+24
12 + 35 + 24 =71
12+35+2+4
12 + 35 + 2 + 4 =53
12+35+2*4
12 + 35 + 8 =55
12+35*24
12 + 840 =852
12+35*2+4
12 + 70 + 4 =86
12+35*2*4
12 + 280 =292
12+3+524
12 + 3 + 524 =539
12+3+52+4
12 + 3 + 52 + 4 =71
12+3+52*4
12 + 3 + 208 =223
12+3+5+24
12 + 3 + 5 + 24 =44
12+3+5+2+4
12 + 3 + 5 + 2 + 4 =26
12+3+5+2*4
12 + 3 + 5 + 8 =28
12+3+5*24
12 + 3 + 120 =135
12+3+5*2+4
12 + 3 + 10 + 4 =29
12+3+5*2*4
12 + 3 + 40 =55
12+3*524
12 + 1572 =1584
12+3*52+4
12 + 156 + 4 =172
12+3*52*4
12 + 624 =636
12+3*5+24
12 + 15 + 24 =51
12+3*5+2+4
12 + 15 + 2 + 4 =33
12+3*5+2*4
12 + 15 + 8 =35
12+3*5*24
12 + 360 =372
12+3*5*2+4
12 + 30 + 4 =46
12+3*5*2*4
12 + 120 =132
12*3524
42288 =42288
12*352+4
4224 + 4 =4228
12*352*4
16896 =16896
12*35+24
420 + 24 =444
12*35+2+4
420 + 2 + 4 =426
12*35+2*4
420 + 8 =428
12*35*24
10080 =10080
12*35*2+4
840 + 4 =844
12*35*2*4
3360 =3360
12*3+524
36 + 524 =560
12*3+52+4
36 + 52 + 4 =92
12*3+52*4
36 + 208 =244
12*3+5+24
36 + 5 + 24 =65
12*3+5+2+4
36 + 5 + 2 + 4 =47
12*3+5+2*4
36 + 5 + 8 =49
12*3+5*24
36 + 120 =156
12*3+5*2+4
36 + 10 + 4 =50
12*3+5*2*4
36 + 40 =76
12*3*524
18864 =18864
12*3*52+4
1872 + 4 =1876
12*3*52*4
7488 =7488
12*3*5+24
180 + 24 =204
12*3*5+2+4
180 + 2 + 4 =186
12*3*5+2*4
180 + 8 =188
12*3*5*24
4320 =4320
12*3*5*2+4
360 + 4 =364
12*3*5*2*4
1440 =1440
1+23524
1 + 23524 =23525
1+2352+4
1 + 2352 + 4 =2357
1+2352*4
1 + 9408 =9409
1+235+24
1 + 235 + 24 =260
1+235+2+4
1 + 235 + 2 + 4 =242
1+235+2*4
1 + 235 + 8 =244
1+235*24
1 + 5640 =5641
1+235*2+4
1 + 470 + 4 =475
1+235*2*4
1 + 1880 =1881
1+23+524
1 + 23 + 524 =548
1+23+52+4
1 + 23 + 52 + 4 =80
1+23+52*4
1 + 23 + 208 =232
1+23+5+24
1 + 23 + 5 + 24 =53
1+23+5+2+4
1 + 23 + 5 + 2 + 4 =35
1+23+5+2*4
1 + 23 + 5 + 8 =37
1+23+5*24
1 + 23 + 120 =144
1+23+5*2+4
1 + 23 + 10 + 4 =38
1+23+5*2*4
1 + 23 + 40 =64
1+23*524
1 + 12052 =12053
1+23*52+4
1 + 1196 + 4 =1201
1+23*52*4
1 + 4784 =4785
1+23*5+24
1 + 115 + 24 =140
1+23*5+2+4
1 + 115 + 2 + 4 =122
1+23*5+2*4
1 + 115 + 8 =124
1+23*5*24
1 + 2760 =2761
1+23*5*2+4
1 + 230 + 4 =235
1+23*5*2*4
1 + 920 =921
1+2+3524
1 + 2 + 3524 =3527
1+2+352+4
1 + 2 + 352 + 4 =359
1+2+352*4
1 + 2 + 1408 =1411
1+2+35+24
1 + 2 + 35 + 24 =62
1+2+35+2+4
1 + 2 + 35 + 2 + 4 =44
1+2+35+2*4
1 + 2 + 35 + 8 =46
1+2+35*24
1 + 2 + 840 =843
1+2+35*2+4
1 + 2 + 70 + 4 =77
1+2+35*2*4
1 + 2 + 280 =283
1+2+3+524
1 + 2 + 3 + 524 =530
1+2+3+52+4
1 + 2 + 3 + 52 + 4 =62
1+2+3+52*4
1 + 2 + 3 + 208 =214
1+2+3+5+24
1 + 2 + 3 + 5 + 24 =35
1+2+3+5+2+4
1 + 2 + 3 + 5 + 2 + 4 =17
1+2+3+5+2*4
1 + 2 + 3 + 5 + 8 =19
1+2+3+5*24
1 + 2 + 3 + 120 =126
1+2+3+5*2+4
1 + 2 + 3 + 10 + 4 =20
1+2+3+5*2*4
1 + 2 + 3 + 40 =46
1+2+3*524
1 + 2 + 1572 =1575
1+2+3*52+4
1 + 2 + 156 + 4 =163
1+2+3*52*4
1 + 2 + 624 =627
1+2+3*5+24
1 + 2 + 15 + 24 =42
1+2+3*5+2+4
1 + 2 + 15 + 2 + 4 =24
1+2+3*5+2*4
1 + 2 + 15 + 8 =26
1+2+3*5*24
1 + 2 + 360 =363
1+2+3*5*2+4
1 + 2 + 30 + 4 =37
1+2+3*5*2*4
1 + 2 + 120 =123
1+2*3524
1 + 7048 =7049
1+2*352+4
1 + 704 + 4 =709
1+2*352*4
1 + 2816 =2817
1+2*35+24
1 + 70 + 24 =95
1+2*35+2+4
1 + 70 + 2 + 4 =77
1+2*35+2*4
1 + 70 + 8 =79
1+2*35*24
1 + 1680 =1681
1+2*35*2+4
1 + 140 + 4 =145
1+2*35*2*4
1 + 560 =561
1+2*3+524
1 + 6 + 524 =531
1+2*3+52+4
1 + 6 + 52 + 4 =63
1+2*3+52*4
1 + 6 + 208 =215
1+2*3+5+24
1 + 6 + 5 + 24 =36
1+2*3+5+2+4
1 + 6 + 5 + 2 + 4 =18
1+2*3+5+2*4
1 + 6 + 5 + 8 =20
1+2*3+5*24
1 + 6 + 120 =127
1+2*3+5*2+4
1 + 6 + 10 + 4 =21
1+2*3+5*2*4
1 + 6 + 40 =47
1+2*3*524
1 + 3144 =3145
1+2*3*52+4
1 + 312 + 4 =317
1+2*3*52*4
1 + 1248 =1249
1+2*3*5+24
1 + 30 + 24 =55
1+2*3*5+2+4
1 + 30 + 2 + 4 =37
1+2*3*5+2*4
1 + 30 + 8 =39
1+2*3*5*24
1 + 720 =721
1+2*3*5*2+4
1 + 60 + 4 =65
1+2*3*5*2*4
1 + 240 =241
1*23524
23524 =23524
1*2352+4
2352 + 4 =2356
1*2352*4
9408 =9408
1*235+24
235 + 24 =259
1*235+2+4
235 + 2 + 4 =241
1*235+2*4
235 + 8 =243
1*235*24
5640 =5640
1*235*2+4
470 + 4 =474
1*235*2*4
1880 =1880
1*23+524
23 + 524 =547
1*23+52+4
23 + 52 + 4 =79
1*23+52*4
23 + 208 =231
1*23+5+24
23 + 5 + 24 =52
1*23+5+2+4
23 + 5 + 2 + 4 =34
1*23+5+2*4
23 + 5 + 8 =36
1*23+5*24
23 + 120 =143
1*23+5*2+4
23 + 10 + 4 =37
1*23+5*2*4
23 + 40 =63
1*23*524
12052 =12052
1*23*52+4
1196 + 4 =1200
1*23*52*4
4784 =4784
1*23*5+24
115 + 24 =139
1*23*5+2+4
115 + 2 + 4 =121
1*23*5+2*4
115 + 8 =123
1*23*5*24
2760 =2760
1*23*5*2+4
230 + 4 =234
1*23*5*2*4
920 =920
1*2+3524
2 + 3524 =3526
1*2+352+4
2 + 352 + 4 =358
1*2+352*4
2 + 1408 =1410
1*2+35+24
2 + 35 + 24 =61
1*2+35+2+4
2 + 35 + 2 + 4 =43
1*2+35+2*4
2 + 35 + 8 =45
1*2+35*24
2 + 840 =842
1*2+35*2+4
2 + 70 + 4 =76
1*2+35*2*4
2 + 280 =282
1*2+3+524
2 + 3 + 524 =529
1*2+3+52+4
2 + 3 + 52 + 4 =61
1*2+3+52*4
2 + 3 + 208 =213
1*2+3+5+24
2 + 3 + 5 + 24 =34
1*2+3+5+2+4
2 + 3 + 5 + 2 + 4 =16
1*2+3+5+2*4
2 + 3 + 5 + 8 =18
1*2+3+5*24
2 + 3 + 120 =125
1*2+3+5*2+4
2 + 3 + 10 + 4 =19
1*2+3+5*2*4
2 + 3 + 40 =45
1*2+3*524
2 + 1572 =1574
1*2+3*52+4
2 + 156 + 4 =162
1*2+3*52*4
2 + 624 =626
1*2+3*5+24
2 + 15 + 24 =41
1*2+3*5+2+4
2 + 15 + 2 + 4 =23
1*2+3*5+2*4
2 + 15 + 8 =25
1*2+3*5*24
2 + 360 =362
1*2+3*5*2+4
2 + 30 + 4 =36
1*2+3*5*2*4
2 + 120 =122
1*2*3524
7048 =7048
1*2*352+4
704 + 4 =708
1*2*352*4
2816 =2816
1*2*35+24
70 + 24 =94
1*2*35+2+4
70 + 2 + 4 =76
1*2*35+2*4
70 + 8 =78
1*2*35*24
1680 =1680
1*2*35*2+4
140 + 4 =144
1*2*35*2*4
560 =560
1*2*3+524
6 + 524 =530
1*2*3+52+4
6 + 52 + 4 =62
1*2*3+52*4
6 + 208 =214
1*2*3+5+24
6 + 5 + 24 =35
1*2*3+5+2+4
6 + 5 + 2 + 4 =17
1*2*3+5+2*4
6 + 5 + 8 =19
1*2*3+5*24
6 + 120 =126
1*2*3+5*2+4
6 + 10 + 4 =20
1*2*3+5*2*4
6 + 40 =46
1*2*3*524
3144 =3144
1*2*3*52+4
312 + 4 =316
1*2*3*52*4
1248 =1248
1*2*3*5+24
30 + 24 =54
1*2*3*5+2+4
30 + 2 + 4 =36
1*2*3*5+2*4
30 + 8 =38
1*2*3*5*24
720 =720
1*2*3*5*2+4
60 + 4 =64
1*2*3*5*2*4
240 =240
========

*/
